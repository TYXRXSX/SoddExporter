<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Отображение Map<String, List<String>></title>
    <style>
        :root {
          --bg: #0b0f14;
          --card: #111826;
          --muted: #8aa0b3;
          --text: #e6edf3;
          --accent: #5ea0ff;
          --border: #1f2a3a;
        }
        html, body {
          height: 100%;
          margin: 0;
          background: var(--bg);
          color: var(--text);
          font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
        }
        .container {
          max-width: 960px;
          margin: 0 auto;
          padding: 16px;
        }
        header {
          display: flex;
          gap: 12px;
          flex-wrap: wrap;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 16px;
        }
        h1 {
          font-size: 1.25rem;
          margin: 0;
        }
        .search {
          position: relative;
          flex: 1 1 260px;
          max-width: 420px;
        }
        .search input {
          width: 100%;
          padding: 10px 12px;
          background: var(--card);
          border: 1px solid var(--border);
          border-radius: 8px;
          color: var(--text);
          outline: none;
        }
        .grid {
          display: grid;
          grid-template-columns: repeat(12, 1fr);
          gap: 12px;
        }
        @media (max-width: 640px) {
          .grid {
            grid-template-columns: 1fr;
          }
        }
        .card {
          grid-column: span 12;
          background: var(--card);
          border: 1px solid var(--border);
          border-radius: 10px;
          padding: 12px;
        }
        .key {
          display: flex;
          align-items: center;
          justify-content: space-between;
          gap: 8px;
          margin: 0 0 6px 0;
          font-weight: 600;
          color: var(--accent);
          word-break: break-word;
        }
        .count {
          font-weight: 500;
          color: var(--muted);
          font-size: 0.9rem;
        }
        ul {
          margin: 8px 0 0 18px;
          padding: 0;
        }
        li {
          margin: 2px 0;
          line-height: 1.4;
          word-break: break-word;
        }
        .empty {
          color: var(--muted);
          font-style: italic;
          margin-left: 2px;
        }
        .no-results {
          color: var(--muted);
          text-align: center;
          margin-top: 24px;
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>Коллекция: Map&lt;String, List&lt;String&gt;&gt;</h1>
        <div class="search">
            <input id="filter" type="search" placeholder="Фильтр по ключу..." aria-label="Фильтр по ключу" />
        </div>
    </header>

    <!-- Если карта пуста -->
    <div th:if="${#maps.isEmpty(items)}" class="no-results">
        Нет данных для отображения
    </div>

    <!-- Список карточек по ключам карты -->
    <div class="grid" th:if="${!#maps.isEmpty(items)}" id="cards">
        <!-- Перебор по entrySet карты -->
        <div class="card" th:each="entry : ${items}">
            <div class="key">
                <span th:text="${entry.key}">ключ</span>
                <span class="count" th:text="'элементов: ' + ${#lists.size(entry.value)}">элементов: 0</span>
            </div>

            <!-- Если список по ключу пуст -->
            <div th:if="${#lists.isEmpty(entry.value)}" class="empty">Список пуст</div>

            <!-- Иначе выводим элементы списка -->
            <ul th:if="${!#lists.isEmpty(entry.value)}">
                <li th:each="val : ${entry.value}" th:text="${val}">значение</li>
            </ul>
        </div>
    </div>
</div>

<script>
    // Простой клиентский фильтр по ключам (без перезагрузки)
    (function () {
      const input = document.getElementById('filter');
      const cards = document.getElementById('cards');
      if (!input || !cards) return;

      const onInput = () => {
        const q = input.value.trim().toLowerCase();
        const items = cards.querySelectorAll('.card');
        let visible = 0;
        items.forEach(card => {
          const keyEl = card.querySelector('.key span');
          const keyText = (keyEl?.textContent || '').toLowerCase();
          const show = keyText.includes(q);
          card.style.display = show ? '' : 'none';
          if (show) visible++;
        });
        const emptyHintId = 'noLocalResults';
        let hint = document.getElementById(emptyHintId);
        if (visible === 0) {
          if (!hint) {
            hint = document.createElement('div');
            hint.id = emptyHintId;
            hint.className = 'no-results';
            hint.textContent = 'Ничего не найдено по фильтру';
            cards.after(hint);
          }
        } else {
          hint?.remove();
        }
      };

      input.addEventListener('input', onInput, { passive: true });
    })();
</script>
</body>
</html>